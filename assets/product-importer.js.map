{"version":3,"names":[],"mappings":"","sources":["product-importer.js"],"sourcesContent":["(function(){function r(e,n,t){function o(i,f){if(!n[i]){if(!e[i]){var c=\"function\"==typeof require&&require;if(!f&&c)return c(i,!0);if(u)return u(i,!0);var a=new Error(\"Cannot find module '\"+i+\"'\");throw a.code=\"MODULE_NOT_FOUND\",a}var p=n[i]={exports:{}};e[i][0].call(p.exports,function(r){var n=e[i][1][r];return o(n||r)},p,p.exports,r,e,n,t)}return n[i].exports}for(var u=\"function\"==typeof require&&require,i=0;i<t.length;i++)o(t[i]);return o}return r})()({1:[function(require,module,exports){\n\"use strict\";\n\njQuery(function ($) {\n  //Every tiny tools are implemented  in gakpHelper as global object literal.\n  var ajaxHelper = {\n    ajax: function ajax(data) {\n      return jQuery.post(product_importer_script.ajax_url, data); //Ajax url,Data\n    }\n  };\n  $(document).ready(function () {\n    var processing = false;\n    var store;\n    var total_page = '';\n    $(document).on(\"change\", \".aadp-country-store\", function (e) {\n      e.preventDefault();\n      $(\".aadp-department\").hide();\n      $(\".buttonload\").remove();\n      $(\".aadp-department\").after('<button class=\"buttonload\"><i class=\"fa fa-spinner fa-spin\"></i>Loading</button>');\n      store = $(this).val();\n      var data = {\n        store: store,\n        action: \"aadp_get_department\"\n      };\n      var request = ajaxHelper.ajax(data);\n      request.done(function (response) {\n        $(\".aadp-department\").empty();\n        $(\".aadp-department\").append(response);\n        $(\".buttonload\").remove();\n        $(\".aadp-department\").show();\n      });\n    });\n    $(document).on(\"click\", \".aadp-pagination > a.page-numbers\", function (e) {\n      e.preventDefault();\n      var url = $(this).attr(\"href\");\n      var urlObject = new URL(url);\n      var page = urlObject.searchParams.get(\"page\");\n      total_page = $(\"#total-pages\").val();\n      aadp_search_for_import_products(url, page, store);\n    });\n    $(document).on(\"click\", \".aadp-search\", function (e) {\n      e.preventDefault();\n      var keyWord = $(\".aadp-keyword\").val().trim();\n\n      if (keyWord != \"\") {\n        store = $(\".aadp-country-store\").val();\n        var department = $(\".aadp-department\").val();\n        var page = 1;\n        var url = store + \"s?k=\" + keyWord + \"&i=\" + department + \"&page=\" + page;\n        aadp_search_for_import_products(url, page, store);\n      }\n    });\n    $(document).on(\"click\", \".aadp-cargo\", function (e) {\n      e.preventDefault();\n      var btn = $(this);\n      btn.attr(\"disabled\", true);\n      aadp_add_to_cargo(btn);\n    });\n    $(document).on(\"click\", \".aadp-cargo-remove\", function (e) {\n      $(this).closest(\"li\").remove();\n      $('#aadp-cargo-counter').text(+$('#aadp-cargo-counter').text() - 1);\n      var req_data = {\n        nonce: product_importer_script.nonce,\n        action: \"aadp_remove_to_cargo\",\n        cargo_key: $(this).closest('li').attr('data-cargo-key')\n      };\n      var request = ajaxHelper.ajax(req_data);\n      request.done(function (response) {\n        aadp_check_empty_cargo();\n      });\n    }); // form-check-input\n\n    $(document).on(\"click\", \"#aadp-add-all\", function (e) {\n      e.preventDefault();\n      $(this).attr(\"disabled\", true);\n      $(\".aadp-cargo\").each(function (idx, el) {\n        var thisBtn = $(this);\n        thisBtn.attr(\"disabled\", true);\n        aadp_add_to_cargo(thisBtn);\n      });\n    });\n    $(document).on(\"change\", \"#aadp-existing-category\", function (e) {\n      e.preventDefault();\n\n      if (this.checked && $('#aadp-xc').length == false) {\n        var selector = $(this);\n        var req_data = {\n          nonce: product_importer_script.nonce,\n          action: \"aadp_get_existing_category\"\n        };\n        var request = ajaxHelper.ajax(req_data);\n        request.done(function (response) {\n          if ($('#aadp-nc').length == true) {\n            $('#aadp-nc').remove();\n          }\n\n          selector.parent().after(response.data);\n        });\n      }\n    });\n    $(document).on(\"change\", \"#create-new-category\", function (e) {\n      e.preventDefault();\n\n      if (this.checked && $('#aadp-nc').length == false) {\n        if ($('#aadp-xc').length == true) {\n          $('#aadp-xc').remove();\n        }\n\n        $(this).parent().after('<div class=\"form-group\" id =\"aadp-nc\">' + '<input type=\"text\" class=\"form-control\" id=\"aadp-category\" placeholder=\"Create category\">' + '</div>');\n      }\n    });\n    var report = [];\n    $(document).on(\"click\", \"#importShortCode\", function (e) {\n      e.preventDefault(); // console.log(navigator.userAgent);\n\n      $('#aadp-operation').remove();\n      processing = true;\n      var loaderPercent = 0;\n      var bar1 = new ldBar(\"#myItem1\");\n      /* ldBar stored in the element */\n\n      var bar2 = document.getElementById('myItem1').ldBar;\n      $('#myItem1').show();\n      bar1.set(loaderPercent);\n      var importUrls = [];\n      $(\".aadp-import-cargo-url\").each(function (idx, el) {\n        importUrls[idx] = {};\n        importUrls[idx].title = $(this).attr(\"data-product-title\").trim();\n        importUrls[idx].url = $(this).attr(\"data-product-url\");\n        importUrls[idx].store = $(this).attr(\"data-store\");\n        importUrls[idx].cargo_key = $(this).attr(\"data-cargo-key\");\n        importUrls[idx].type = $(this).attr(\"data-type\");\n      });\n      var categoryType = $(\"input[name='aadp-category-type']:checked\").val();\n      var categoryVal = $('#aadp-category').val();\n      var proCount = importUrls.length; // console.log(\"product :\" + proCount);\n\n      var ajaxRequestCount = proCount; // console.log(ajaxRequestCount);\n\n      var proPercent = 100 / ajaxRequestCount * proCount;\n      var perProPercent = proPercent / proCount;\n\n      if (Array.isArray(importUrls) && importUrls.length) {\n        var i = 0;\n        report.product = [];\n        $.each(importUrls, function (indexInArray, valueOfElement) {\n          i++;\n          valueOfElement.cat_type = categoryType;\n          valueOfElement.cat_val = categoryVal;\n          var req_data = {\n            nonce: product_importer_script.nonce,\n            action: \"aadp_cargo_import\",\n            import_data: valueOfElement\n          }; // console.log(req_data);\n\n          productPromise(req_data).then(function (response) {\n            // console.log(response);\n            report.product[indexInArray] = [];\n            report.product[indexInArray].message = response.data.message; // console.log(\"p:\" + perProPercent);\n\n            loaderPercent += perProPercent;\n            bar1.set(loaderPercent); // console.log(response);\n\n            $(\"ul\").find(\"[data-cargo-key='\".concat(response.data.cargo_key, \"']\")).remove();\n            $('#aadp-cargo-counter').text(+$('#aadp-cargo-counter').text() - 1); //aadp_check_empty_cargo();\n\n            if (i == importUrls.length) {\n              if (parseInt(loaderPercent) == 100) {\n                // console.log(\"uu\" + loaderPercent);\n                processing = false; // console.log(report);\n\n                $('#myItem1').hide();\n                bar1.set(0);\n                aadp_check_empty_cargo();\n                $('.aadp_loader').append('<div id =\"aadp-operation\"><div class=\"row\"><div class=\"col-7\"><p class=\"alert alert-success aadp-operation center\">Hurray!! Job Completed.</p></div><div class=\"col-5\"><p id=\"aadp-import-report\" class=\"btn btn-info \">View Report</p><div></div> </div>');\n              }\n            }\n          })[\"catch\"](function (error) {\n            console.log(error);\n          });\n        });\n      }\n    });\n    $(document).on(\"click\", \"#aadp-import-report\", function (e) {\n      e.preventDefault();\n      $(\"#reportModalCenter\").remove(); // console.log(report);\n\n      var reportMessage = '';\n      reportMessage += '<div class=\"modal fade\" id=\"reportModalCenter\" tabindex=\"-1\" role=\"dialog\" aria-labelledby=\"exampleModalCenterTitle\"' + '    aria-hidden=\"true\">' + '    <div class=\"modal-dialog modal-dialog-centered\" role=\"document\">' + '        <div class=\"modal-content modal-design\">' + '            <div class=\"modal-header\">' + '                <h5 class=\"modal-title aadp_modal_title aadp_modal_title_design\" id=\"exampleModalLongTitle\">Import Report</h5>' + '                <button type=\"button\" class=\"btn-close\" data-bs-dismiss=\"modal\" aria-label=\"Close\">' + // '                    <span aria-hidden=\"true\">Ã—</span>' +\n      '                </button>' + '            </div>' + '            <div class=\"modal-body\">';\n      reportMessage += '<p class=\"product_report_title\"><strong>Product Report:</strong></p>';\n      reportMessage += '<ul>';\n      $.each(report.product, function (indexInArray, valueOfElement) {\n        // console.log(valueOfElement.shortcode);\n        reportMessage += ' <li class=\"product_report_title\">' + valueOfElement.message + ' </li>';\n      });\n      reportMessage += '</ul>' + '            </div>' + '        </div>' + '    </div>' + '</div>';\n      $(this).after(reportMessage);\n      $(\"#reportModalCenter\").modal(\"show\"); // console.log(reportMessage);\n    });\n    $(document).on(\"click\", \"a\", function (e) {\n      // console.log(processing);\n      if (processing == true) {\n        confirm(\"Product Importing operation is processing! Are you sure you want to leave?\");\n      }\n    }); // btn btn-sm btn-success\n\n    $(document).on(\"click\", \".aadp-product-research\", function (e) {\n      e.preventDefault();\n      $(\"#researchModalCenter\").remove();\n      var thisBtn = $(this);\n      var url = thisBtn.attr('data-product-link');\n      var req_data = {\n        nonce: product_importer_script.nonce,\n        action: 'aadp_product_research',\n        url: url\n      }; // console.log(req_data);\n\n      var request = ajaxHelper.ajax(req_data);\n      request.done(function (response) {\n        // console.log(response.data);\n        thisBtn.after(response.data);\n        $(\"#researchModalCenter\").modal(\"show\");\n      });\n    });\n\n    if ($('#aadp-import-product').length == true) {\n      window.onscroll = function () {\n        myFunction();\n      };\n    }\n\n    function aadp_check_empty_cargo() {\n      if ($('.aadp-import-cargo-url').length == false) {\n        // console.log('')\n        $('.shopping-cart-items').append('<li class=\"aadp-empty-cargo\"><h6>Your cargo is currently empty.</h6></li>');\n      }\n    }\n\n    function myFunction() {\n      var header = document.getElementById(\"aadp-gol\");\n      var sticky = header.offsetTop;\n\n      if (window.pageYOffset > sticky) {\n        header.classList.add(\"sticky\");\n      } else {\n        header.classList.remove(\"sticky\");\n      }\n    }\n\n    (function () {\n      $(\"#cart\").on(\"click\", function () {\n        $(\"#aadp-cargo-box\").fadeToggle(\"fast\");\n      });\n    })();\n\n    function aadp_search_for_import_products(url, page, store) {\n      var req_data = {\n        nonce: product_importer_script.nonce,\n        action: \"product_find\",\n        store: store,\n        url: url,\n        page: page,\n        total_page: total_page\n      };\n      var request = ajaxHelper.ajax(req_data);\n      request.done(function (response) {\n        // console.log(response);\n        $(\"#aadp-import-product\").empty();\n        $(\"#aadp-import-product\").append(response.data);\n        $(\"html,body\").animate({\n          scrollTop: $(\"#aadp-gol\").offset().top\n        }, \"slow\");\n      });\n    }\n\n    function aadp_add_to_cargo(btn) {\n      var title = btn.attr(\"data-product-title\");\n      var img = btn.attr(\"data-product-img\");\n      var url = btn.attr(\"data-product-link\");\n      var store = btn.attr(\"data-product-store\");\n      var type = btn.parents(\".card-body\").find(\".aadp-type\").val();\n      var req_data = {\n        nonce: product_importer_script.nonce,\n        action: \"aadp_store_cargo\",\n        title: title,\n        img: img,\n        url: url,\n        type: type,\n        store: store\n      };\n      var request = ajaxHelper.ajax(req_data);\n      request.done(function (response) {\n        if ($(\".aadp-empty-cargo\").length > 0) {\n          $(\".aadp-empty-cargo\").remove();\n        }\n\n        var html = ' <li class=\"clearfix aadp-import-cargo-url\" data-product-title=\"' + title + '\" data-product-url=\"' + url + '\" data-type=\"' + type + '\" data-cargo-key=\"' + response.data + '\"data-store=\"' + store + '\">' + '<div class=\"row\">' + '<div class=\"col-2 \">' + '<img src=\"' + img + '\" alt=\"item1\" />' + '</div>' + '<div class=\"col-8 \">';\n        html += '<span class=\"item-name\">' + title + '</span>' + '</div>' + '<div class=\"col-2\">' + '<button class=\"btn btn-sm btn-danger aadp-cargo-remove\">x</button>' + '</div>';\n        '</div>';\n        html += \"</li>\";\n        $(\".shopping-cart-items\").append(html);\n        var counter = +$('#aadp-cargo-counter').text() + 1;\n        $('#aadp-cargo-counter').text(counter);\n      });\n    }\n  });\n\n  var productPromise = function productPromise(req_data) {\n    return new Promise(function (resolve, reject) {\n      var request = ajaxHelper.ajax(req_data);\n      request.done(function (response) {\n        resolve(response); // console.log(response);\n      });\n    });\n  };\n});\n\n},{}]},{},[1]);\n"],"file":"product-importer.js"}